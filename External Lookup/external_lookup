import csv
import sys
import socket
import json
import requests as req

def dummy_api_call(requestURL, parameters):
    response=req.get(url=requestURL,params=parameters)
    if response.status_code != 200:
        print('Status: ', response.status_code,'Headers: ',response.headers,'Error Response: ',response.json())
        exit()
    data=response.json()
    return json.dumps(data)


# Given a productid, find the productdesc
def lookup(productid):
    try:
        descriptions = []
        requestURL = "https://dummyjson.com/products?select=description"
        parameter = {}
        description_list = dummy_api_call(requestURL, parameter)
        data = json.loads(description_list)
        for description in data["products"]:
            if productid == "*":
                descriptions.append(description)
            elif str(description["id"]) == str(productid):
                descriptions.append(description)
                break
        return descriptions
    except:
        return []

# Given an productdesc, return the productid
def rlookup(productdesc):
    try:
        descriptions = []
        requestURL = "https://dummyjson.com/products?select=description"
        parameter = {}
        description_list = dummy_api_call(requestURL, parameter)
        data = json.loads(description_list)
        for description in data["products"]:
            if productdesc == "*":
                descriptions.append(description)
            elif str(description["description"]) == str(productdesc):
                descriptions.append(description)
                break
        return descriptions
    except:
        return []